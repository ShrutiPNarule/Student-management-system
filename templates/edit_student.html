{% extends "base.html" %}
{% block content %}

{% if session.get("role") != "admin" %}
    <h3 style="color:red;">Unauthorized Access</h3>
    <p>You do not have permission to edit student records.</p>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Go Back</a>

{% else %}

<div class="form-card">
    <h2>Edit Student</h2>

    <form method="POST" novalidate>

        <!-- ===== BASIC DETAILS ===== -->
        <div class="form-row">
            <div class="form-group">
                <label>Student Name</label>
                <input
                    type="text"
                    name="name"
                    value="{{ student[1] }}"
                    required
                    pattern="[A-Za-z ]{2,}"
                    title="Name must contain only letters"
                >
            </div>

            <div class="form-group">
                <label>Roll Number</label>
                <input
                    type="text"
                    name="roll_no"
                    value="{{ student[2] }}"
                    required
                    maxlength="20"
                >
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Date of Birth</label>
                <input
                    type="date"
                    name="dob"
                    value="{{ student[12] }}"
                    required
                >
            </div>

            <div class="form-group">
                <label>Birth Place</label>
                <input
                    type="text"
                    name="birth_place"
                    value="{{ student[13] }}"
                    required
                    maxlength="100"
                >
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Category</label>
                <select name="category" required>
                    <option value="">-- Select Category --</option>
                    <option value="General" {% if student[14] == 'General' %}selected{% endif %}>General</option>
                    <option value="OBC" {% if student[14] == 'OBC' %}selected{% endif %}>OBC</option>
                    <option value="SC" {% if student[14] == 'SC' %}selected{% endif %}>SC</option>
                    <option value="ST" {% if student[14] == 'ST' %}selected{% endif %}>ST</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>College</label>
                <input
                    type="text"
                    name="college"
                    value="{{ student[5] }}"
                    required
                >
            </div>

            <div class="form-group">
                <label>Phone</label>
                <input
                    type="text"
                    name="phone"
                    value="{{ student[3] }}"
                    required
                    pattern="[0-9]{10}"
                    maxlength="10"
                    inputmode="numeric"
                    title="Enter a valid 10-digit phone number"
                >
            </div>
        </div>

        <div class="form-group">
            <label>Email</label>
            <input
                type="email"
                name="email"
                value="{{ student[4] }}"
                required
            >
        </div>

        <!-- ===== SCHOOL MARKS ===== -->
        <h3>School Marks</h3>
        <div class="form-row">
            <div class="form-group">
                <label>10th Marks</label>
                <input
                    type="number"
                    name="marks_10th"
                    value="{{ student[6] }}"
                    min="0"
                    max="100"
                >
            </div>

            <div class="form-group">
                <label>12th Marks</label>
                <input
                    type="number"
                    name="marks_12th"
                    value="{{ student[7] }}"
                    min="0"
                    max="100"
                >
            </div>
        </div>

        <!-- ===== COLLEGE MARKS ===== -->
        <h3>College Marks</h3>
        <div class="form-row">
            <div class="form-group">
                <label>Marks Semester 1</label>
                <input
                    type="number"
                    name="marks1"
                    value="{{ student[10] }}"
                    min="0"
                    max="100"
                >
            </div>

            <div class="form-group">
                <label>Marks Semester 2</label>
                <input
                    type="number"
                    name="marks2"
                    value="{{ student[11] }}"
                    min="0"
                    max="100"
                >
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Marks Semester 3</label>
                <input
                    type="number"
                    name="marks3"
                    value="{{ student[12] }}"
                    min="0"
                    max="100"
                >
            </div>

            <div class="form-group">
                <label>Marks Semester 4</label>
                <input
                    type="number"
                    name="marks4"
                    value="{{ student[13] }}"
                    min="0"
                    max="100"
                >
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Marks Semester 5</label>
                <input
                    type="number"
                    name="marks5"
                    value="{{ student[14] }}"
                    min="0"
                    max="100"
                >
            </div>

            <div class="form-group">
                <label>Marks Semester 6</label>
                <input
                    type="number"
                    name="marks6"
                    value="{{ student[15] }}"
                    min="0"
                    max="100"
                >
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Marks Semester 7</label>
                <input
                    type="number"
                    name="marks7"
                    value="{{ student[16] }}"
                    min="0"
                    max="100"
                >
            </div>

            <div class="form-group">
                <label>Marks Semester 8</label>
                <input
                    type="number"
                    name="marks8"
                    value="{{ student[17] }}"
                    min="0"
                    max="100"
                >
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">Update Student</button>
            <a href="{{ url_for('index') }}" class="btn btn-secondary">Cancel</a>
        </div>

    </form>
</div>

{% endif %}
{% endblock %}
